{"title":"在RaspberryPi上启用AirPlay","url":"/raspberrypi-airplay-shairport/","content":"<blockquote>\n<p>浙江大学嵌入式系统课程</p>\n</blockquote>\n<p><strong>准备工作</strong></p>\n<ul>\n<li>连入局域网的Raspberry Pi（有线或无线均可）</li>\n<li>迷你音箱一个</li>\n<li>连入相同局域网内的iOS设备</li>\n</ul>\n<p><strong>更改缺省的音频输出端口</strong></p>\n<p>将缺省的音频输出端口指向标准耳机端口而非原先的HDMI。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">sudo</span> amixer cset numid=<span class=\"number\">3</span> <span class=\"number\">1</span></div></pre></td></tr></table></figure>\n\n<p><strong>安装shairport所需的包</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">sudo</span> apt-get install git libao-dev libssl-dev libcrypt-openssl-rsa-perl libio-socket-inet6-perl libwww-perl avahi-utils libmodule-build-perl</div></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<p><strong>安装Perl Net-SDP，主要用于兼容iOS6</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">git clone https://github.com/njh/perl-net-sdp.git perl-net-sdp</div><div class=\"line\"><span class=\"built_in\">cd</span> perl-net-sdp</div><div class=\"line\">perl Build.PL</div><div class=\"line\"><span class=\"built_in\">sudo</span> ./Build</div><div class=\"line\"><span class=\"built_in\">sudo</span> ./Build test</div><div class=\"line\"><span class=\"built_in\">sudo</span> ./Build install</div></pre></td></tr></table></figure>\n\n<p><img src=\"http://img.nilennoct.com/wp-content/uploads/2013/03/Task_08_01.png\" alt=\"Task_08_01\"></p>\n<p><strong>安装shairport并启动服务</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">git clone https://github.com/hendrikw82/shairport.git</div><div class=\"line\"><span class=\"built_in\">cd</span> shairport</div><div class=\"line\"><span class=\"built_in\">sudo</span> make</div></pre></td></tr></table></figure>\n\n<p><img src=\"http://img.nilennoct.com/wp-content/uploads/2013/03/Task_08_02.png\" alt=\"Task_08_02\"></p>\n<p><strong>在RPi上开启shairport</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./shairport.pl <span class=\"operator\">-a</span> NeoAir</div></pre></td></tr></table></figure>\n\n<p>其中NeoAi为Airport的服务名称，可以更具需要自行设置。</p>\n<p><img src=\"http://img.nilennoct.com/wp-content/uploads/2013/03/Task_08_03.png\" alt=\"Task_08_03\"></p>\n<p><strong>测试</strong></p>\n<p>打开iPad，在播放音乐时选择NeoAir，声音即在RPi上播放出来了。</p>\n<p><img src=\"http://img.nilennoct.com/wp-content/uploads/2013/03/Task_08_04.png\" alt=\"Task_08_04\"></p>\n<p>实际使用过程中，初次播放时有比较大的噪音。断开重新连接AirPlay后声音恢复正常。</p>\n<blockquote>\n<p>本文内容参考 <a href=\"http://jordanburgess.com/post/38986434391/raspberry-pi-airplay\" target=\"_blank\" rel=\"external\">Hacking a Raspberry Pi into a wireless airplay speaker</a></p>\n</blockquote>\n","layout":"post"}