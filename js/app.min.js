require.config({paths:{jquery:"/lib/jquery/dist/jquery.min",zepto:"/lib/zeptojs/dist/zepto.min",underscore:"/lib/underscore-amd/underscore.min",backbone:"/lib/backbone-amd/backbone.min","jquery.fancybox":"/lib/fancybox/source/jquery.fancybox.pack"},shim:{zepto:{exports:"$"},"jquery.fancybox":{deps:["jquery"],exports:"jQuery.fn.fancybox"}}});(function(){var b="jquery";var d="click";var a=(function f(){return(typeof window.orientation!=="undefined")||(navigator.userAgent.indexOf("IEMobile")!==-1)})();var c=(function g(){return"ontouchend" in window})();if(a){d="touchend"}require([b],function(h){h.fn.tap=function(j,l){if(typeof l==="undefined"){l=j;j=undefined}if(c){var k=null;var i=0;this.on("touchstart",j,function(m){k=m.originalEvent.touches[0];i=m.originalEvent.timestamp}).on("touchend",j,function(n){var m=n.originalEvent.changedTouches[0];if(n.originalEvent.timestamp-i>=400){return}if(Math.max(Math.abs(m.clientX-k.clientX),Math.abs(m.clientY-k.clientY))>10){return}l.call(this,n);n.preventDefault()}).on("click",j,function(m){m.preventDefault()})}else{this.on("click",j,l)}};h(document).ready(function(){var j=h("#main");e("article");h("#header-control").tap(function(){h("#header").toggleClass("open")});h("#main-nav").tap("a",function(){h("#header").removeClass("open")});h("#logo").tap(function(){j.scrollTop(0)});if(typeof history.pushState!=="undefined"){var k=h("#loadingMask");var i={title:document.title,content:j.html()};h("body").tap("a",function(m){var l="";if(m.target.tagName==="A"){l=m.target.href}else{l=h(m.target).parents("a")[0].href}if(!new RegExp(location.host).test(l)){return}if(m.defaultPrevented){return}if(location.href!==l){k.addClass("show");h.get(l).done(function(o){var n=h(o.match(/<head[^>]*>[\s\S]*<\/head>/)[0]);var q=h(o.match(/<body[^>]*>[\s\S]*<\/body>/)[0]);var p={title:n.filter("title").text(),content:q.filter("#main").html()};history.pushState(p,p.title,l);console.log(document.location.href);j.html(p.content).scrollTop(0);document.title=p.title}).fail(function(){console.error("Network error >_<")}).always(function(){k.removeClass("show");e("article")})}m.stopPropagation();m.preventDefault()});h(window).on("popstate",function(l){var m=l.originalEvent.state||i;j.html(m.content).scrollTop(0);document.title=m.title})}})});require(["jquery","jquery.fancybox"],function(h){h(".fancybox").fancybox()});function e(h){$(h).find("img").each(function(i,k){var j=$(k);j.wrap('<a class="fancybox" href="'+k.src+'" title="'+k.alt+'"></a>')})}})();