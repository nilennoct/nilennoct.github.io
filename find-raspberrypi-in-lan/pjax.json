{"title":"在局域网内查找RaspberryPi","url":"/find-raspberrypi-in-lan/","content":"<blockquote>\n<p>浙江大学嵌入式系统课程</p>\n</blockquote>\n<p>使用路由器连接Raspberry Pi，可以很容易的使用SSH登录管理Raspberry Pi，不过这首先需要知道RPi在路由器上分配到的IP地址。</p>\n<p>比较简单的方法就是进入路由器的管理界面，在DHCP客户端列表查找以“b8:27:eb”开始的MAC地址，如下图所示；</p>\n<p><img src=\"http://img.nilennoct.com/wp-content/uploads/2013/03/Task_06_01.png\" alt=\"Task_06_01\"></p>\n<p>此外，我们也可以通过编写脚本自动扫描所在局域网内的所有IP，然后从ARP表中寻找符合条件的MAC地址和IP。</p>\n<p>以BAT脚本为例。<br><a id=\"more\"></a></p>\n<p>新建一个“Find_my_RPi.bat”文件，输入以下内容后保存。</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">@<span class=\"keyword\">echo</span> off</div><div class=\"line\">:: Author: Neo He</div><div class=\"line\">color <span class=\"number\">0</span>a</div><div class=\"line\">title Find my RPi [Neo He]</div><div class=\"line\">cls</div><div class=\"line\">:: Find your IP <span class=\"flow\">in</span> LAN.</div><div class=\"line\"><span class=\"flow\">for</span> /f \"tokens=<span class=\"number\">2</span> delims=:\" <span class=\"envvar\">%%i</span> <span class=\"flow\">in</span> ('\"<span class=\"winutils\">ipconfig</span> | findstr /i /r \"IPv4.*<span class=\"number\">192</span>\\.<span class=\"number\">168</span>\\.[<span class=\"number\">0</span>-<span class=\"number\">9</span>]*\\.[<span class=\"number\">0</span>-<span class=\"number\">9</span>]*\"\"') <span class=\"flow\">do</span> <span class=\"keyword\">set</span> m=<span class=\"envvar\">%%i</span></div><div class=\"line\"><span class=\"flow\">for</span> /f \"tokens=<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span> delims=.\" <span class=\"envvar\">%%i</span> <span class=\"flow\">in</span> (\"<span class=\"envvar\">%m%</span>\") <span class=\"flow\">do</span> <span class=\"keyword\">set</span> ip=<span class=\"envvar\">%%i</span>.<span class=\"envvar\">%%j</span>.<span class=\"envvar\">%%k</span>.</div><div class=\"line\">:: <span class=\"winutils\">Ping</span> all IP <span class=\"flow\">in</span> your LAN.</div><div class=\"line\"><span class=\"flow\">for</span> /l <span class=\"envvar\">%%i</span> <span class=\"flow\">in</span> (<span class=\"number\">1</span>,<span class=\"number\">1</span>,<span class=\"number\">255</span>) <span class=\"flow\">do</span> <span class=\"winutils\">ping</span> -w <span class=\"number\">100</span> -n <span class=\"number\">1</span> <span class=\"envvar\">%ip%</span><span class=\"envvar\">%%i</span></div><div class=\"line\">cls</div><div class=\"line\"><span class=\"keyword\">echo</span>.Find my RPi:</div><div class=\"line\">:: Look <span class=\"flow\">for</span> MAC of RPi.</div><div class=\"line\"><span class=\"flow\">for</span> /f \"usebackq tokens=<span class=\"number\">1</span>,<span class=\"number\">2</span>\" <span class=\"envvar\">%%i</span> <span class=\"flow\">in</span> (&lt;code&gt;\"arp -a | find \"b8-<span class=\"number\">27</span>-eb\"\"&lt;/code&gt;) <span class=\"flow\">do</span> (</div><div class=\"line\"><span class=\"keyword\">echo</span>. ------------------------------</div><div class=\"line\"><span class=\"keyword\">echo</span>.  RPi's IP: <span class=\"envvar\">%%i</span></div><div class=\"line\"><span class=\"keyword\">echo</span>.  RPi's MAC: <span class=\"envvar\">%%j</span></div><div class=\"line\">)</div><div class=\"line\"><span class=\"keyword\">echo</span>. ------------------------------</div><div class=\"line\"><span class=\"keyword\">echo</span>.</div><div class=\"line\"><span class=\"keyword\">pause</span></div></pre></td></tr></table></figure>\n\n<p>运行后结果如下图所示。</p>\n<p><img src=\"http://img.nilennoct.com/wp-content/uploads/2013/03/Task_06_02.png\" alt=\"Task_06_02\"></p>\n","layout":"post"}