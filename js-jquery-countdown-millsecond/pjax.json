{"title":"JS实现倒计时的一种方法","url":"/js-jquery-countdown-millsecond/","content":"<p>最近因为需要试着用Javascript写了一个带毫秒倒计时的小程序，代码如下：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">span</span> <span class=\"attribute\">class</span>=<span class=\"value\">\"min\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"title\">span</span>&gt;</span>:<span class=\"tag\">&lt;<span class=\"title\">span</span> <span class=\"attribute\">class</span>=<span class=\"value\">\"sec\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"title\">span</span>&gt;</span>.<span class=\"tag\">&lt;<span class=\"title\">span</span> <span class=\"attribute\">class</span>=<span class=\"value\">\"millisec\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"title\">span</span>&gt;</span></div></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> inter;</div><div class=\"line\"><span class=\"keyword\">var</span> countdown = <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(min)</span> </span>{</div><div class=\"line\">\t<span class=\"keyword\">var</span> date = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</div><div class=\"line\">\t<span class=\"keyword\">var</span> endTime = date.getTime() + <span class=\"built_in\">parseInt</span>(min) * <span class=\"number\">60</span> * <span class=\"number\">1000</span>;</div><div class=\"line\">\t<span class=\"keyword\">var</span> $min = $(<span class=\"string\">'.min'</span>);</div><div class=\"line\">    clearInterval(inter);</div><div class=\"line\">\tinter = setInterval(<span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">()</span> </span>{</div><div class=\"line\">\t\t<span class=\"keyword\">var</span> st = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</div><div class=\"line\">\t\t<span class=\"keyword\">var</span> startTime = st.getTime();</div><div class=\"line\">\t\t<span class=\"keyword\">var</span> leftTime = <span class=\"built_in\">Math</span>.floor((endTime - startTime) / <span class=\"number\">100</span>);</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (leftTime &lt;= <span class=\"number\">0</span>) {</div><div class=\"line\">\t\t\tclearInterval(inter);</div><div class=\"line\">\t\t\tinter = <span class=\"literal\">null</span>;</div><div class=\"line\">\t\t\t$.each($min, <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(i, t)</span> </span>{</div><div class=\"line\">\t\t\t\t$(t).text(<span class=\"string\">'0'</span>).next().text(<span class=\"string\">'0'</span>).next().text(<span class=\"string\">'0'</span>);</div><div class=\"line\">\t\t\t});</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span>;</div><div class=\"line\">\t\t}</div><div class=\"line\">\t\t$.each($min, <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(i, t)</span> </span>{</div><div class=\"line\">\t\t\t$(t).text(<span class=\"built_in\">Math</span>.floor(leftTime / <span class=\"number\">600</span>)).next().text(<span class=\"built_in\">Math</span>.floor(leftTime / <span class=\"number\">10</span>) % <span class=\"number\">60</span>).next().text(leftTime % <span class=\"number\">10</span>);</div><div class=\"line\">\t\t});</div><div class=\"line\">\t}, <span class=\"number\">100</span>);</div><div class=\"line\">};</div></pre></td></tr></table></figure>\n\n<p>使用countdown(1)可实现一分钟的倒计时.</p>\n","layout":"post"}