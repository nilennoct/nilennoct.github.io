{"title":"在RaspberryPi上安装DHCP服务器","url":"/raspberrypi-install-dhcp-server/","content":"<blockquote>\n<p>浙江大学嵌入式系统课程</p>\n</blockquote>\n<p><strong>确定DHCP服务端软件</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">dpkg --list | grep dhcp</div></pre></td></tr></table></figure>\n\n<p><img src=\"http://img.nilennoct.com/wp-content/uploads/2013/03/Task_11_01.png\" alt=\"Task_11_01\"></p>\n<p>由图中可知道，RPi默认安装的dhcp客户端是isc-dhcp-client，不难想到对应的服务端应该是isc-dhcp-server。<br><a id=\"more\"></a></p>\n<p><strong>安装isc-dhcp-server</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">sudo</span> apt-get install isc-dhcp-server</div></pre></td></tr></table></figure>\n\n<p>如下图这样，安装完初次启动服务失败是正常的，因为此时尚未对其进行配置。</p>\n<p><img src=\"http://img.nilennoct.com/wp-content/uploads/2013/03/Task_11_02.png\" alt=\"Task_11_02\"></p>\n<p><strong>配置DHCP服务器</strong></p>\n<p>使用ifconfig命令，可以看到RPi只有eth0一个网卡，接下来就要把DHCP服务器绑定在eth0上。<br>编辑/etc/default/isc-dhcp-server文件，修改</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"constant\">INTERFACES</span>=<span class=\"string\">\"eth0\"</span></div></pre></td></tr></table></figure>\n\n<p>编辑/etc/dhcp/dhcpd.conf文件，按如下内容修改</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">subnet <span class=\"number\">192.168</span><span class=\"number\">.0</span><span class=\"number\">.0</span> netmask <span class=\"number\">255.255</span><span class=\"number\">.255</span><span class=\"number\">.0</span> {</div><div class=\"line\">\trange <span class=\"number\">192.168</span><span class=\"number\">.0</span><span class=\"number\">.100</span> <span class=\"number\">192.168</span><span class=\"number\">.0</span><span class=\"number\">.254</span>;</div><div class=\"line\">\t<span class=\"keyword\">option</span> domain-name-servers <span class=\"number\">8.8</span><span class=\"number\">.8</span><span class=\"number\">.8</span>; #Google的公共DNS</div><div class=\"line\">\t<span class=\"keyword\">option</span> domain-name <span class=\"string\">\"Neo DHCP\"</span>;</div><div class=\"line\">\t<span class=\"keyword\">option</span> routers <span class=\"number\">192.168</span><span class=\"number\">.0</span><span class=\"number\">.1</span>;</div><div class=\"line\">\t<span class=\"keyword\">option</span> broadcast-address <span class=\"number\">192.168</span><span class=\"number\">.0</span><span class=\"number\">.255</span>;</div><div class=\"line\">\t<span class=\"keyword\">default</span>-lease-<span class=\"built_in\">time</span> <span class=\"number\">600</span>;</div><div class=\"line\">\tmax-lease-<span class=\"built_in\">time</span> <span class=\"number\">7200</span>;</div><div class=\"line\">}</div></pre></td></tr></table></figure>\n\n<p>启动DHCP服务器</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">sudo</span> service isc-dhcp-server start</div></pre></td></tr></table></figure>\n\n<p><strong>测试效果</strong></p>\n<p>下图是笔记本尚未连接RPi时ifconfig的输出结果，注意eth0。</p>\n<p><img src=\"http://img.nilennoct.com/wp-content/uploads/2013/03/Task_11_03.png\" alt=\"Task_11_03\"></p>\n<p>下图是笔记本连接了RPi后ifconfig的输出结果，可以看到eth0已经按我们配置的那样顺利获取到了IP。</p>\n<p><img src=\"http://img.nilennoct.com/wp-content/uploads/2013/03/Task_11_04.png\" alt=\"Task_11_04\"></p>\n<p>至此RPi上DHCP的配置就告一段落了。</p>\n","layout":"post"}